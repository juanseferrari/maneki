<!-- Pagos Section -->
<section id="section-servicios" class="content-section">
  <div class="section-header">
    <h1>Pagos y Suscripciones</h1>
    <p>Gestiona tus pagos recurrentes y predice tus gastos futuros</p>
  </div>

  <!-- Actions Bar -->
  <div class="services-actions-bar">
    <button class="btn-primary" onclick="openAddServiceModal()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      Agregar Pago
    </button>
    <button class="btn-secondary" onclick="detectRecurringServices()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      Detectar Automaticamente
    </button>
  </div>

  <!-- Services Table Section -->
  <div class="services-table-section">
    <div class="services-table-header">
      <h3>Mis Pagos</h3>
      <div class="services-filter">
        <select id="services-status-filter" onchange="filterServices()">
          <option value="active">Activos</option>
          <option value="paused">Pausados</option>
          <option value="all">Todos</option>
        </select>
      </div>
    </div>

    <!-- Loading State -->
    <div class="services-loading" id="services-loading">
      <div class="spinner"></div>
      <span>Cargando pagos...</span>
    </div>

    <!-- Empty State -->
    <div class="services-empty" id="services-empty" style="display: none;">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
      <p>No hay pagos registrados</p>
      <span>Agrega pagos manualmente o detecta automaticamente</span>
    </div>

    <!-- Services Table -->
    <div class="services-table-container" id="services-table-container" style="display: none;">
      <table class="services-table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Categoria</th>
            <th>Frecuencia</th>
            <th>Monto</th>
            <th>Proximo Pago</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody id="services-table-body">
          <!-- Services will be loaded here -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Upcoming Payments Summary -->
  <div class="upcoming-payments-section">
    <h3>Próximos Pagos</h3>
    <div class="upcoming-payments-list" id="upcoming-payments-list">
      <!-- Will be populated by JS -->
    </div>
  </div>
</section>

<!-- Add/Edit Service Modal -->
<div class="custom-modal-overlay" id="service-modal">
  <div class="custom-modal add-service-modal">
    <div class="custom-modal-header">
      <div class="custom-modal-icon info">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
      </div>
      <h3 class="custom-modal-title" id="service-modal-title">Agregar Servicio</h3>
    </div>

    <form id="service-form" onsubmit="saveService(event)" class="service-form">
      <input type="hidden" id="service-id" value="">

      <div class="form-row">
        <div class="form-group">
          <label for="service-name">Nombre del servicio *</label>
          <input type="text" id="service-name" required placeholder="Ej: Netflix, Edenor, Expensas">
        </div>
        <div class="form-group">
          <label for="service-category">Categoría</label>
          <select id="service-category">
            <option value="streaming">Streaming</option>
            <option value="utilities">Servicios (luz, gas, agua)</option>
            <option value="telecommunications">Telecomunicaciones</option>
            <option value="insurance">Seguros</option>
            <option value="subscriptions">Suscripciones</option>
            <option value="memberships">Membresías</option>
            <option value="housing">Vivienda</option>
            <option value="loans">Préstamos</option>
            <option value="other">Otro</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="service-frequency">Frecuencia *</label>
          <select id="service-frequency" required>
            <option value="weekly">Semanal</option>
            <option value="biweekly">Quincenal</option>
            <option value="monthly" selected>Mensual</option>
            <option value="bimonthly">Bimestral</option>
            <option value="quarterly">Trimestral</option>
            <option value="semiannual">Semestral</option>
            <option value="annual">Anual</option>
          </select>
        </div>
        <div class="form-group">
          <label for="service-day">Día típico de cobro</label>
          <input type="number" id="service-day" min="1" max="31" placeholder="1-31">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="service-amount">Monto estimado</label>
          <input type="number" id="service-amount" step="0.01" placeholder="0.00">
        </div>
        <div class="form-group">
          <label for="service-currency">Moneda</label>
          <select id="service-currency">
            <option value="ARS">ARS (Peso Argentino)</option>
            <option value="USD">USD (Dólar)</option>
            <option value="EUR">EUR (Euro)</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group checkbox-group">
          <label>
            <input type="checkbox" id="service-amount-varies">
            El monto varía cada mes (ej: servicios públicos)
          </label>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="service-payment-method">Método de pago</label>
          <select id="service-payment-method">
            <option value="">Sin especificar</option>
            <option value="debit_auto">Débito automático</option>
            <option value="credit_card">Tarjeta de crédito</option>
            <option value="manual">Pago manual</option>
            <option value="transfer">Transferencia</option>
          </select>
        </div>
        <div class="form-group">
          <label for="service-color">Color</label>
          <input type="color" id="service-color" value="#607D8B">
        </div>
      </div>

      <div class="form-group">
        <label for="service-notes">Notas</label>
        <textarea id="service-notes" rows="2" placeholder="Notas adicionales..."></textarea>
      </div>

      <div class="custom-modal-actions">
        <button type="button" class="custom-modal-btn btn-cancel" onclick="closeServiceModal()">Cancelar</button>
        <button type="submit" class="custom-modal-btn btn-confirm">Guardar</button>
      </div>
    </form>
  </div>
</div>

<!-- Detected Services Modal -->
<div class="custom-modal-overlay" id="detected-modal">
  <div class="custom-modal detected-services-modal">
    <div class="custom-modal-header">
      <div class="custom-modal-icon info">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </div>
      <h3 class="custom-modal-title">Servicios Detectados</h3>
    </div>
    <p class="custom-modal-message">
      Encontramos los siguientes pagos recurrentes en tus transacciones. Selecciona los que quieras agregar.
    </p>

    <div class="detected-services-list" id="detected-services-list">
      <!-- Will be populated by JS -->
    </div>

    <div class="custom-modal-actions">
      <button type="button" class="custom-modal-btn btn-cancel" onclick="closeDetectedModal()">Cancelar</button>
      <button type="button" class="custom-modal-btn btn-confirm" onclick="saveSelectedDetected()">
        Agregar Seleccionados
      </button>
    </div>
  </div>
</div>

<!-- Service Detail Modal removed - now using right-sidebar -->
